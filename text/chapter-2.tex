% -*- coding: utf-8; -*-

\chapter{Modelling Heat Flow}

\section{1D Heat Transport}

Before diving in the microscopic models, let us first describe the basic heat flow problem from a macroscopic point of view so that afterwards it can be compared to our toy model. Suppose we have a solid bar with length $ L $, cross sectional area $ A $ and thermal conductivity $ \kappa $ in contact with two thermal baths, one on each side and with temperatures $ T_{1},T_{2} $ such that $ T_{1} > T_{2} $.

\begin{figure}[H] 
		\centering 
		\fontsize{18}{14} 
		\scalebox{0.8}{\incfig{ch2_1}} 
		\label{ch2_1} 
		\caption{one dimensional heat transport}
\end{figure} 


We further assume that $ L^{2} \gg A $, the lateral surface of the bar is isolated from the environment and $ \kappa $ does not vary with temperature. In this case Fourier's law takes the form
\[ \dot{Q} = -\kappa \frac{d T}{d x}. \]

It is expected that, as time goes to infinity, our system approaches a steady state where the heat flux $ \dot{Q} $ is constant, and as such we can use the boundary conditions $ T(x=0)=T_{1} $ and $ T(x=L)=T_{2} $ to integrate our function and get
\[ T = - \frac{(T_{1}-T_{2})}{L}\cdot x + T_{1}, \]
showing that the temperature profile along the bar in the steady state is linear.

\begin{figure}[H] 
		\centering 
		\fontsize{26}{14} 
		\scalebox{0.6}{\incfig{ch2_2}} 
		\label{ch2_2} 
		\caption{linear temperature profile.}
\end{figure} 


It is also possible to use the heat equation to look at the dynamics of the system and see the evolution of the system as $ t\to \infty $. In fact, if we divide the bar in small slabs of size $ \Delta x $ (partition the interval $ [0,L] $ in intervals $ [x,x+\Delta x] $) and then use the first law of thermodynamics to approximate for a given slab
\[ 
	(\dot{Q}(t,x) - \dot{Q}(t,x+\Delta x))A\Delta t = 
	(u(t+\Delta t,x) - u(t,x)) A \Delta x,
\]
where $ u $ is the specific internal energy of the bar (considered homogeneous), then
\[ 
	-\frac{\partial \dot{Q}}{\partial x} = 
	\frac{\partial u }{\partial t}
 \]
in the limit $ \Delta x\to 0, \Delta t\to 0$. Now using the concept of specific heat capacity we could write $ u = C\rho T $, and so
\[ 
	-\frac{\partial \dot{Q}}{\partial x} = 
	C \rho \frac{\partial T }{\partial t},
 \]
which together with Fourier's law gives us the heat equation
\[ 
	\frac{\partial^{2} T}{\partial x^{2}} = 
	\alpha^{2} \frac{\partial T }{\partial t},
\]
where the definition $ \alpha^{2} = C \rho / \kappa $ was used. Considering that the bar have an initial temperature profile $ f(x) $, its solution is given by
\[ 
	T(x,t) = - \frac{(T_{1} - T_{2})}{L}\cdot x + T_{1} +
	\sum_{n=1}^{\infty} c_{n} e^{-(n\pi\alpha/L)^{2} t}
	\sin \left( \frac{n\pi x}{L} \right),
\]
where
\[ 
	c_{n} = \frac{2 }{L }\int_{0}^{L} 
	\left[ f(x) - \frac{(T_{2} - T_{1})}{L}\cdot x - T_{1}\right]
	\sin \left(\frac{n\pi x }{L}\right)dx,
 \]
from which it can be seen that the transient part goes to zero exponentially with characteristic time $ \tau \propto L^{2}/\alpha^{2} $.

\section{Mathematical Model}

The mathematical model studied here replaces the bar by a chain of particles with first-neighbors interactions and two Langevin heat baths on the extremities which interacts by a quadratic potential with the ends of the chains.

\begin{figure}[H] 
		\centering 
		\fontsize{18}{14} 
		\scalebox{0.8}{\incfig{ch2_3}} 
		\label{ch2_3} 
		\caption{pictorial representation of the mathematical model}
\end{figure} 

Both parts of the system will be further discussed in the next sections.

\subsection{Heat Baths}

There are two main types of models that are used as heat baths. The first one is known as the Nosé-Hoover thermostat.


The heat baths at each side of the chain are simulated as Langevin heat baths with elastic potential due to its nearest neighbors interactions (this model is similar to the one on , but we eliminate the external string potential).

\begin{equation}\label{eq:1}
\boxed{
	\begin{aligned}
	&\frac{d v_1}{dt} = -\gamma v_1 + \eta_1(t) -k\left(x_1 - x_2\right);\\
	&\frac{d v_i}{dt} = -k\left(2x_i - x_{i-1} - x_{i+1}\right);\\
	&\frac{d v_N}{dt} = -\gamma v_N + \eta_N(t) -k\left(x_N - x_{N-1}\right);
	\end{aligned}
}
\end{equation}

Where $i=2,3,...,N-1$, and $x_i$ is the displacement from equilibrium for each particle, which is given by:
$$\frac{d x_1}{dt} = v_1,\; \frac{d x_i}{dt} = v_i,\; \frac{d x_N}{dt} = v_N;$$

The variables $\eta_1$ and $\eta_2$ are uncorrelated Gaussian processes, $\gamma$ is the drag coefficient for the Langevin baths and $k$ can be seen as the spring constant (assuming unit mass for all particles), or as the rescaled spring constant with respect to the particle masses, but either way it's assumed to be the same for all interactions.

The Hamiltonian corresponding to the linear chain is given by:
$$H = \sum_{i=2}^{N} \frac{p_i^2}{m_i} + \frac{k}{2}(x_i-x_{i-1})^2;$$
%
%\begin{figure}[H]
%	\centering
%	\begin{tikzpicture}
%	\tikzstyle{spring}=[decoration={segment length=1mm, amplitude=1mm, coil}, decorate]
%	\node[circle,draw=black,inner sep=1.5mm] (a) at (1.3,1) {};
%	\node[circle,draw=black,inner sep=1.5mm] (b) at (2.5,1) {};
%	\node[circle,draw=black,inner sep=1.5mm] (c) at (3.7,1) {};
%	\node[circle,draw=black,inner sep=1.5mm] (d) at (4.9,1) {};
%	\node[circle,draw=black,inner sep=1.5mm] (e) at (6.1,1) {};
%	\draw[spring] (a) -- (b); 
%	\draw[spring] (b) -- (c);
%	\draw[spring] (c) -- (d);
%	\draw[spring] (d) -- (e);
%	\draw[fill = white!30!red](0,0)rectangle(1.1,2)node[pos=.5]{$\boldsymbol{T_1}$};
%	\draw[fill = white!30!blue](6.3,0)rectangle(7.4,2)node[pos=.5]{$\boldsymbol{T_2}$};
%	\end{tikzpicture}
%	\caption{Pictorial representation of the system described by the system of equations \ref{eq:1}}
%	\label{fig:system}
%\end{figure}

\section{The Frenkel-Kontorova Model}

\section{The Model}

The Frenkel Kontorova model for a linear chain of particles can be seen as being described by a Hamiltonian of the form 
\[ \mathcal{H} = K + U_{int} + U_{sub} \]

\begin{itemize}
	\item $ K $ is the kinetic energy
	\item $ U_{int} $ is the interaction potential between the particles
	\item $ U_{sub} $ is a "substrate" potential characterizing the interaction of the particles with its surrounding.
\end{itemize}

Opening each term, we have:
\[ 
\mathcal{H} = \underbrace{\sum_{i=1}^{N}\frac{p_{i}^{2}}{2m_i}}_{K} + 
\underbrace{\sum_{i=1}^{N} \frac{k_i}{2}(x_{i} - x_{i-1} - a)^{2}}_{U_{int}} +
\underbrace{\sum_{i=1}^{N} V_{0,i}\left[1 - \cos \left( \frac{2\pi x_{i}}{a_{s}}\right)\right]}_{U_{sub}}
\]

Where $ x_i $ is the position of the i-th particle. Assuming the equilibrium position of i-th particle is given by $ i\cdot a $, we can write $ x_i = ia + q_{i}$, where $ q_{i} $ is the particle displacement from equilibrium. Also:
\[ \frac{dx_{i}}{dt} =  \frac{dq_{i}}{dt}\]

From which we can rewrite:

\[ 
\mathcal{H} = \sum_{i=1}^{N}\frac{p_{i}^{2}}{2m_i} + 
\sum_{i=1}^{N} \frac{k_i}{2}(q_{i} - q_{i-1})^{2} +
\sum_{i=1}^{N} V_{0,i}\left[1 - 
\cos \left( \frac{2\pi i a}{a_{s}} + \frac{2\pi q_{i}}{a_{s}}\right)\right]
\]

We can see that $ U_{sub} $ is periodic with period $ a_s $, where the $ x_i = n a_s $ is the minimum of the potential (equilibrium position).

Assuming that $ a/a_s = k\in \mathbb{N} $, we get:
\[ 
\cos \left( \frac{2\pi i a}{a_{s}} + \frac{2\pi q_{i}}{a_{s}}\right) = 
\cos \left( 2\pi k i  + \frac{2\pi q_{i}}{a_{s}}\right) = 
\cos \left( 2\pi k'  + \frac{2\pi q_{i}}{a_{s}}\right)
\]

Which is just
\[ \cos \left( \frac{2\pi q_{i}}{a_{s}}\right) \]

Hence, 
\[ 
\mathcal{H} = \sum_{i=1}^{N}\frac{p_{i}^{2}}{2m_i} + 
\sum_{i=1}^{N} \frac{k_i}{2}(q_{i} - q_{i-1})^{2} +
\sum_{i=1}^{N} V_{0,i}\left[1 - 
\cos \left( \frac{2\pi q_{i}}{a_{s}}\right)\right]
\]
%
%The equations of motion are
%\[
%\dot{p_i} = -\frac{\partial\mathcal{H}}{\partial q_i}, \;
%\dot{q_i} = \frac{\partial\mathcal{H}}{\partial p_i}, \;
%\]
%
%Assuming the particles $ i=1,N $ represent the thermal baths, we have for $ i=2, 3, \dots, N-1 $:
%\begin{align*}
%&\frac{dq_i}{dt} = \frac{p_{i}}{m_i} \\
%&\frac{dp_i}{dt} = -k_{i}(q_{i}-q_{i-1}) + k_{i}(q_{i+1}-q_i) - 
%\frac{2\pi V_{0,i}}{a_s}\sin \left(\frac{2\pi q_i}{a_s}\right)
%\end{align*}
%
%Rewriting, 
%\begin{align*}
%&\frac{dq_i}{dt} = \frac{p_{i}}{m_i} \\
%&\frac{dp_i}{dt} = -k_{i}(q_{i}-q_{i-1}) - k_{i}(q_{i} - q_{i+1}) - 
%\frac{2\pi V_{0,i}}{a_s}\sin \left(\frac{2\pi q_i}{a_s}\right)
%\end{align*}
%
%To make a thermal diode, we make so that the first $ N/2 $ particles have parameters $ k_i = k_{L}, V_{0,i} = V_{L} $ while the other half have different parameters $ k_i = k_{R}, V_{0,i} = V_{R} $, and connect the two halves by yet a third spring constant, $ k_{int} $.
%
%\section{Polynomial Interaction}
%
%Let us assume that the middle particles ( particles $ N/2 $ and $ N/2+1 $) interact by different forces. We shall assume that their interaction is given by:
%\[ V\left(q_{\frac{N}{2}}, q_{\frac{N}{2}+1}\right) = \frac{k_{\mu}}{\mu}
%\left|q_{\frac{N}{2}+1} - q_{\frac{N}{2}}\right|^{\mu} \]
%
%Thus, the force between them is given by:
%\[ F_{q_{\frac{N}{2}}} = -\frac{dV}{dq_{\frac{N}{2}}} = 
%- k_{\mu}\left|q_{\frac{N}{2}+1} - q_{\frac{N}{2}} \right|^{\mu-2}
%\left(q_{\frac{N}{2}} - q_{\frac{N}{2}+1}\right)\]
%
%\[ F_{q_{\frac{N}{2}+1}} = -\frac{dV}{dq_{\frac{N}{2}+1}} = 
%-k_{\mu}\left|q_{\frac{N}{2}+1} - q_{\frac{N}{2}} \right|^{\mu-2}
%\left(q_{\frac{N}{2}+1} - q_{\frac{N}{2}}\right)\]
%
%But they will still feel the forces due to the other particles. Rewriting these two particles equations of motion (let $ n=N/2 $):
%\begin{align*}
%&\frac{dq_n}{dt} = \frac{p_{n}}{m_n} \\
%&\frac{dp_n}{dt} = -k_L(q_{n}-q_{n-1}) - 
%k_{\mu}\left|q_{n+1} - q_{n} \right|^{\mu-2} \left(q_{n} - q_{n+1}\right) - 
%\frac{2\pi V_L}{a_s}\sin \left(\frac{2\pi q_n}{a_s}\right) \\
%&\frac{dq_{n+1}}{dt} = \frac{p_{n+1}}{m_{n+1}}  \\
%&\frac{dp_{n+1}}{dt} = -k_R(q_{n+1}-q_{n+2}) -
%k_{\mu}\left|q_{n+1} - q_{n} \right|^{\mu-2} \left(q_{n+1} - q_{n}\right) - 
%\frac{2\pi V_R}{a_s}\sin \left(\frac{2\pi q_{n+1}}{a_s}\right)
%\end{align*}
%
%\section{Simulation}
%
%To simulate this system, we use the Fourth Order Stochastic Runge-Kutta method, with parameters given below.
%
%\begin{itemize}
%	\item Number of particles in the chain varied from $ N = 10,20,30,40,50,100,150,200  $
%	\item The time step of the method is always the same, $ \tau=0.1 $
%	\item The time interval of the simulation varied between $ 10^6 $ and $ 10^7 $
%\end{itemize}
%
%For this simulation, we define most of the physical parameters of the system, and change only the exponent in the polynomial interaction, using 120 copies of a given exponent.
%
%However, to simplify the code, we use the same scheme as Casati's paper to choose the parameters. First, we choose $ m_i=a=1, \; \forall i=1, 2, 3, \dots, N $. 
%
%Beyond that, we think of the chain as two parts, the left having parameters $ k_L, V_L, T_L $, the right having $ k_R, V_R, T_R $ and the middle potential having $ k_{int} $. From this, we set:
%
%\begin{mdframed}
%	\[ V_R=\lambda V_L, \quad k_R=\lambda k_L, \quad T_L=T_0 (1+\Delta),\quad T_R = T_0 (1-\Delta) \]
%\end{mdframed}
%
%Meaning that $ T_L - T_R = 2T_0\Delta $, $ T_L + T_R = 2T_0 $. We also choose the amplitude of the heat baths as being $ 2\gamma T $, where $ \gamma $ is the drag coefficient of the Langevin equations (This is the noise amplitude to have temperature $ T $ in the simple brownian motion). The chosen physical parameters are:
%
%\begin{itemize}
%	\item $ Delta=0.5 $ (Difference of temperature)
%	\item $ lambda=1.0 $ (Ratio of spring constants)
%	\item $ k_{int}=1.0 $ (Spring constant between segments)
%	\item $ T=0.07 $ (Mean temperature)
%	\item $ mu=1.0,1.5,2.0,3.0,4.0 $ (Polynomial Interaction)
%	\item $ V_{L} = 5/(4\pi^{2})$ (Amplitude of the cosine potential on the left)
%	\item $ k_{L} = 1 $ (Spring constant on the left)
%	\item $ gama = 1 $ (Drag coefficient)
%\end{itemize}
%
%The temperature of the i-th particle is calculated as the ensemble average of the time average of the square velocity.
%\[ T_i =  \frac{\sum_{k=1}^{N_{f}} \langle v_{i}^2 \rangle_{time}}{N_{f}} \]
%
%Where $ N_f $ is the number of copies in the ensemble.
%
%To calculate the thermal current along the chain (we define the right direction as positive and left direction as negative), we make the ensemble average of the time average of the power corresponding to the force of the left particle on the right particle, $ v_i F_{i-1, i} $. For each segment:
%\[ \sum_{k=1}^{N_{f}}\langle  k(q_{i-1}-q_{i}) v_{i} \rangle_{time} / N_{f} \]
%
%However, for the middle particle thats in the right segment, the interaction is polynomial, thus:
%\[ k_{\mu}\left|q_{n+1} - q_{n} \right|^{\mu-2} \left(q_{n} - q_{n+1}\right) \]
%
%\section{Theoretical Considerations}
%
%
%We are using the Frenkel-Kontorova model (FK model) for a linear chain of particles
%
%\[ 
%\mathcal{H} = \sum_{i=1}^{N}\frac{p_{i}^{2}}{2m} + 
%\underbrace{\sum_{i=1}^{N} \frac{k}{2}(x_{i} - x_{i-1} - a)^{2}}_{U_{int}} +
%\underbrace{\sum_{i=1}^{N} V_{0}\left[1 - \cos \left( \frac{2\pi 
%		x_{i}}{a_{s}}\right)\right]}_{U_{ext}}
%\]
%
%Beyond that we assume a white-noise acting on the first and N-th particles, adding energy to the system, besides a dissipation term (Langevin baths).
%
%\[ m\ddot{x}_{1} = \underbrace{k(x_{2}-x_{1}-a)+
%	V_{0}\left[1-\cos \left(\frac{2\pi x_{1} }{a_{s}}\right)\right]}_{
%	Frenkel-Kontorova}
%\underbrace{-\gamma\dot{x}_{1} + \eta_{1}(t)}_{Langevin}\]
%
%
%\[ m\ddot{x}_{N} = \underbrace{-k(x_{N}-x_{N-1}-a)+
%	V_{0}\left[1-\cos \left(\frac{2\pi x_{N} }{a_{s}}\right)\right]}_{
%	Frenkel-Kontorova}
%\underbrace{-\gamma\dot{x}_{N} + \eta_{N}(t)}_{Langevin}\]
%
%
%\subsection{Equilibrium Configuration}
%
%Assuming that $ x_{1} = 0 $ and $ x_{N}=N\cdot a_{s} $ are constant, we have:
%
%\[ \frac{\partial U}{\partial x_{n}} = 
%\frac{\partial U_{int}}{x_{n}} + \frac{\partial U_{ext}}{\partial x_{n}} = 0 \]
%
%\[ \frac{\partial U }{\partial x_{n} }  = 
%k(2x_{n} - x_{n+1} - x_{n-1}) + 
%\frac{2\pi V_{0} }{a_{s} }\sin \left(\frac{2\pi x_{n} }{a_{s} }\right) = 
%0
%\]
%
%Whose solution is then given by $ x_{n}=na_{s} $. In fact, as long as the particles are in the external potential valleys, the elastic forces are only important as long as the distance from particle $ n $ to particles $ n+1 $ and $ n-1 $ is the same, so that the resulting elastic force is zero.
%
%\subsection{Phonon Band}
%
%If we assume small oscillations near the equilibrium position, we can expand $ U $ in a Taylor series up to second order (since first order is zero in the equilibrium).
%
%\[ U_{ext} = \sum_{n=1}^{N} 
%V_{0}\left[1-\cos \left(\frac{2\pi x_{n} }{a_{s} }\right)\right]
%\approx 
%\frac{1 }{2 }\sum_{n=1}^{N}\frac{4\pi^{2}V_{0} }{a_{s}^{2} }q_{n}^{2} \]
%
%Where $ q_{n} = x_{n} - n\cdot a_{s} $. We can also expand the interaction potential up to second order near the equilibrium configuration.
%\[ U_{int} \approx U_{int}(x_{eq}) + 
%\sum_{n=1}^{N} \frac{\partial U_{int} }{\partial x_{n} } q_{n} +
%\frac{1 }{2 } \sum_{n=1}^{N} \sum_{m=1}^{N} 
%\frac{\partial^{2} U_{int} }{\partial x_{n} \partial x_{m} }q_{n}q_{m} \]
%\[U_{int} \approx  \frac{Nk}{2}(a_{s} - a)^{2} + 
%\frac{1 }{2 }\sum_{n=1}^{N} \sum_{m=1}^{N} 
%(2k\delta_{m,n} - k\delta_{m,n-1} - k\delta_{m,n+1})q_{n}q_{m}  \]
%
%\[ U_{int}\approx \frac{Nk}{2}(a_{s} - a)^{2} +
%\frac{1 }{2 } \sum_{n=1}^{N} 2kq_{n}^{2} -kq_{n}q_{n-1} - kq_{n}q_{n+1} \]
%
%Then, from the Hamilton equations of motion:
%
%\[ m\ddot{q}_{n} = -\frac{\partial \mathcal{H} }{\partial q_{n} } =
%- \frac{\partial U }{\partial q_{n}} \approx
%- \left(
%\frac{4\pi^{2} V_{0} }{a_{s}^{2} }q_{n} + 2kq_{n} -kq_{n-1}-kq_{n+1}
%\right)\]
%
%Now, if we try the ansatz $ q_{n} = A\exp\left\{ i\omega t - ikna_{s} \right\} $, we then get:
%
%\[ -\omega^{2} m A \exp\left\{i\omega t - ikna_{s}\right\} =
%-A\exp\left\{i\omega t - ikna_{s}\right\}\left(
%\frac{4\pi^{2} V_{0} }{a_{s}^{2} } + 2k -k(e^{ika_{s}} + e^{-ika_{s}})
%\right) 
%\]
%\[ \omega^{2}m = \frac{4\pi^{2} V_{0} }{a_{s}^{2} } + 2k(1-\cos(ka_{s}))  \]
%
%\begin{mdframed}
%	\[ \omega = 
%	\sqrt{\frac{4\pi^{2} V_{0} }{m a_{s}^{2} } + \frac{4k }{m }
%		\sin^{2}\left(\frac{ka_{s} }{2 }\right)} \]
%\end{mdframed}
%
%This means that $ \sqrt{V_{0}}\leq\omega\leq\sqrt{V_{0}+4k} $ if we assume $ m=1, a_{s}=2\pi $. If we assume that the external potential term is negligible in comparison to the internal potential term and the kinetic potential, we can approximate $ V_{0} \approx 0 $, and as such $ 0 \leq \omega \leq 2\sqrt{k} $.
%
%
%\subsection{Polynomial Interaction between chains}
%
%The above derivation neglects the boundary effects, so it can't capture the changes needed in the case of a different interface potential.
%
%\section{Theoretical Considerations}
%
%\subsection{Small oscillations}
%
%We are using the Frenkel-Kontorova model (FK model) for a linear chain of particles
%
%\[ 
%\mathcal{H} = \sum_{i=1}^{N-1}\frac{p_{i}^{2}}{2m} + 
%\underbrace{\sum_{i=1}^{N} \frac{k}{2}(x_{i} - x_{i-1} - a)^{2}}_{U_{int}} +
%\underbrace{\sum_{i=1}^{N-1} V_{0}\left[1 - \cos \left( \frac{2\pi 
%		x_{i}}{a_{s}}\right)\right]}_{U_{ext}}
%\]
%
%\subsubsection{One particle case}
%
%Assume only three particles, one in each thermal bath and one that follows the Frenkel-Kontorova model, so $ x_{0}, x_{2} $ are given (maybe as functions of time, maybe at equilibrium position). Let us look at the Lagrangian.
%
%\[ 
%\mathcal{L} = \frac{m }{2}\dot{x}_{1}^{2} - 
%\frac{k}{2}(x_{1} - x_{0} - a)^{2} - \frac{k}{2}(x_{2} - x_{1} - a)^{2} -
%V_{0}\left[1 - \cos \left( \frac{2\pi x_{1}}{a_{s}}\right)\right]
%\]
%
%Now, to look at equilibrium, we shall assume in fact that $ x_{0}=0,x_{2}=2a_{s} $. So, we have for equilibrium:
%
%\[ \frac{\partial U}{\partial x_{1}} = 
%\frac{\partial U_{int}}{x_{1}} + \frac{\partial U_{ext}}{\partial x_{1}} = 0 \]
%\[ \frac{\partial U_{int}}{x_{1}} = k (x_{1} - x_{0}-a) - 
%k (x_{2} - x_{1} - a) = k(2x_{1} - x_{2} - x_{0})\]
%\[ \frac{\partial U_{ext} }{\partial x_{1}} = \frac{2\pi V_{0} }{a_{s} } 
%\sin \left(\frac{2\pi x_{1} }{a_{s} }\right)\]
%
%\[ \frac{\partial U }{x_{1} }  = 
%k(2x_{1} - x_{2} - x_{0}) + 
%\frac{2\pi V_{0}}{a_{s} }\sin \left(\frac{2\pi x_{1} }{a_{s} }\right) = 
%0
%\]
%
%Since we assumed equilibrium positions for $ x_{2},x_{0} $, we have that $ x_{1,eq} = a_{s} $. Notice that if $ a_{s}\neq a $ then the elastic forces on particle 1 are $ F_{el}=k(a_{s}-a) $ and as such the resulting force in will indeed be zero, since $ \vec{F}_{n,n-1}=-\vec{F}_{n+1,n} $.
%
%Now, we can try to look at the solution for small vibrations around the equilibrium position $ q_{1}=x_{1} - a_{s} $.
%
%\[ \left(\frac{\partial^{2} U}{\partial x_{1}^{2} }\right)_{x_{1} =a_{s}} = 
%2k + \frac{4\pi^{2} V_{0} }{a_{s}^{2} } \]
%
%\[ U\approx k(a_{s}-a)^{2} + 
%\frac{1 }{2 }\left( 2k + \frac{4\pi^{2} V_{0} }{a_{s}^{2} } \right) q_{1}^{2} \]
%
%Now we replace this approximation in the Lagrangian.
%
%\[ 
%\mathcal{L} = \frac{m }{2}\dot{q}_{1}^{2} - k(a_{s}-a)^{2} - 
%\frac{1 }{2 }\left( 2k + \frac{4\pi^{2} V_{0} }{a_{s}^{2} } \right) q_{1}^{2}
%\]
%
%Looking at the Euler-Lagrange equations, we then have:
%
%\[\frac{d}{dt}\left(\frac{\partial \mathcal{L}}{\partial \dot{q}_{1}}\right)-
%\frac{\partial \mathcal{L}}{\partial q_{1} } = 0 \]]
%\[ m\ddot{q} + \left( 2k + \frac{4\pi^{2}V_{0} }{a_{s}^{2} }\right)q=0 \]
%
%In this case, we have small oscillations around the equilibrium position $ x_{1} = a_{s} $ with frequency
%\[ \omega=\frac{2k }{m } \left(1+\frac{4\pi^{2}V_{0} }{a_{s}^{2} 2k }\right).\]
%
%Notice first that we could change the equilibrium position by changing the position $ x_{2} $, and as a matter of fact, $ x_{2} = 2Na_{s}\implies x_{1}=Na_{s} $.
%
%Also, if we had that $ x_{0},x_{2} $ were not stationary, the equilibrium position would change with time. In this case, we would have:
%
%\[ 2kx_{1} - k(x_{2}+x_{0}) = 
%-\frac{2\pi V_{0} }{a_{s} }\sin \left(\frac{2\pi x_{1} }{a_{s} }\right) \]
%
%
%\[ x_{1} = \frac{x_{0}+x_{2} }{2 } - 
%\frac{\pi V_{0}}{k a_{s} }\sin\left( \frac{2\pi x_{1} }{a_{s} }\right) \]
%
%If $ x_{2}+x_{0}=2a_{s} $ all the time, then we would have the equilibrium position, $ x_{1}=a_{s} $ at all times. In other cases, this equation is not simple to solve analytically (at least I don't know how), although we are always sure there is always at least one solution.
%
%The problem is actually that we may have multiple solutions, and it is not simple to decide which to use. If we tried a simple condition like $ x_{0}<x_{1}<x_{2} $ for example, then we could even have no solution  at all.
%
%So we should look at which $ k,a_{s},V_{0} $ are necessary so that our condition would be met. Although we may still fall in the problem of having multiple solutions, no one being better than the other.
%
%Another problem we shall have is that now $ U=U(x,t) $, and as such we cannot use the same approximation we used before.
%
%\subsubsection{Many particle case}
%
%Assume, now we have $ N-1 $ particles following the Frenkel-Kontorova model and that $ x_{0}=0,x_{N} = Na_{s} $.
%\[ 
%\mathcal{L} = \sum_{i=1}^{N-1}\frac{m}{2}\dot{x}_{i} - 
%\sum_{i=1}^{N} \frac{k}{2}(x_{i} - x_{i-1} - a)^{2} -
%\sum_{i=1}^{N-1} V_{0}\left[1 - \cos \left( \frac{2\pi 
%	x_{i}}{a_{s}}\right)\right]
%\]
%
%Again, the equilibrium is given by:
%\[ \frac{\partial U}{\partial x_{n}} = 
%\frac{\partial U_{int}}{x_{n}} + \frac{\partial U_{ext}}{\partial x_{n}} = 0 \]
%
%\[ \frac{\partial U_{int}}{\partial x_{n}} = k (x_{n} - x_{n-1}-a) - 
%k (x_{n+1} - x_{n} - a) = k(2x_{n} - x_{n+1} - x_{n-1})\]
%
%\[ \frac{\partial U_{ext} }{\partial x_{n}} = \frac{2\pi V_{0} }{a_{s} } 
%\sin \left(\frac{2\pi x_{n} }{a_{s} }\right)\]
%
%\[ \frac{\partial U }{\partial x_{n} }  = 
%k(2x_{n} - x_{n+1} - x_{n-1}) + 
%\frac{2\pi V_{0} }{a_{s} }\sin \left(\frac{2\pi x_{n} }{a_{s} }\right) = 
%0
%\]
%
%A possible solution is $ x_{n} = n\cdot a_{s} $ and again this does not correspond to all forces being zero, but only to the resulting force being so. Also, if $ x_{N} = N\cdot L\cdot a_{s} $ then the equilibrium configuration would be $ x_{n} = n\cdot L\cdot a_{s} $, if $ L\in \mathbb{N} $.
%
%This time, to calculate the small vibrations around the equilibrium position $ q_{n}=x_{n} - na_{s} $ we need to take the cross derivatives.
%
%\[ \left(\frac{\partial^{2} U}{\partial x_{m} \partial x_{n} }\right)_{x_{n} =na_{s}} = 
%\left(2k+ \frac{4\pi^{2}V_{0} }{a_{s}^{2} }\right)\delta_{m,n} - 
%k\delta_{m,n-1} - k\delta_{m,n+1} \]
%
%\[ U\approx \sum_{i=1}^{N}\frac{k }{2 }(a_{s}-a)^{2} + 
%\frac{1 }{2 }\sum_{m,n}
%\left(\left(2k+ \frac{4\pi^{2}V_{0} }{a_{s}^{2} }\right)\delta_{m,n} - 
%k\delta_{m,n-1} - k\delta_{m,n+1}\right)q_{n}q_{m} \]
%
%\[ U\approx \sum_{i=1}^{N}\frac{k }{2 }(a_{s}-a)^{2} + 
%\frac{1 }{2 }\sum_{n}
%\left(2k+ \frac{4\pi^{2}V_{0} }{a_{s}^{2} }\right)q_{n}^{2} -
%kq_{n}q_{n-1} - kq_{n}q_{n+1}
%\]
%
%\[ U\approx \frac{Nk}{2}(a_{s}-a)^{2} + \frac{1}{2}\sum_{n}
%\lambda q_{n}^{2} -
%kq_{n}q_{n-1} - kq_{n}q_{n+1}
%\]
%
%
%Where $ \lambda =  2k+ 4\pi^{2}V_{0}/a_{s}^{2}$. If we do not assume periodic boundary conditions, then we need to put at the end and beginning of the chain:
%\[ U_{1} = \frac{1 }{2 } \left(\lambda q_{1}^{2} - kq_{1}q_{2}\right) \]
%\[ U_{N-1} = \frac{1 }{2 }\left( \lambda q_{N-1}^{2}-kq_{N-1}q_{N-2}\right)  \]
%
%
%
%Now we look for the equations of motion:
%\[ 
%\mathcal{L} = \sum_{i=1}^{N-1}\frac{m}{2}\dot{q}_{i}^{2} - 
%\frac{Nk}{2}(a_{s}-a)^{2} - \frac{1}{2}\sum_{i=1}^{N-1}
%\left(\lambda q_{n}^{2} -
%kq_{n}q_{n-1} - kq_{n}q_{n+1}\right)
%\]
%\[\frac{d}{dt}\left(\frac{\partial \mathcal{L}}{\partial \dot{q}_{n}}\right)-
%\frac{\partial \mathcal{L}}{\partial q_{n} } = 0 \]
%
%We have to be careful to notice that $ q_{n} $ show on three terms of the summation of the potential, $ U_{n},\;U_{n-1},\;U_{n+1} $. This being the case we have $ \partial_{q_{n}} U_{n-1} = -(k/2)q_{n-1}$, $ \partial_{q_{n}} U_{n+1}=-(k/2)q_{n+1} $, and then summing with the derivative of $ U_{n} $, we got:
%\[ m\ddot{q}_{n} +\lambda q_{n} - k(q_{n-1} + q_{n+1}) = 0 \]
%
%Where I didn't fix for the boundaries just to simplify notation. But we always need to remember that:
%\[ m\ddot{q}_{1} +\lambda q_{1} - k q_{2} = 0  \]
%\[ m\ddot{q}_{N-1} +\lambda q_{N-1} - k q_{N-2} = 0   \]
%
%
%We can thus calculate the caracteristic frequencies and the normal modes of vibrations. Let
%
%
%\[ \textbf{M} = \frac{1 }{m }
%\left[
%\begin{array}{cccccc}
%\lambda & -k & 0 & 0 & \dots & 0 \\ 
%-k & \lambda & -k & 0 & \dots & 0 \\ 
%0 & -k & \lambda & -k & \dots & 0 \\ 
%\vdots & \vdots &  &  &  & \vdots \\ 
%0 & 0 & \dots & -k & \lambda & -k \\ 
%0 & 0 & \dots & 0 & -k & \lambda
%\end{array}
%\right]  \]
%
%Then we can rewrite our equations of motion as:
%\[ \ddot{\vec{q}}  = -\textbf{M} \vec{q}\]
%
%We can then calculate the eigenvalues of $ \textbf{M} $ using a closed form derived in the appendix (we will write them as being squared). 
%\[ \omega_{k}^{2} = \frac{\lambda}{m} - 2\frac{k }{m }\cos\left(\frac{l\pi }{n }\right),\; l=1,2,\dots,n-1 \]
%
%Thus, the eigenvectors of $ \textbf{M} $ with eigenvalue $ \omega_{k} $ are given by:
%\[  \]
%
%\textcolor{red}{The eigenvectors of $ \textbf{M} $ will be complex exponentials, since they have to solve the ODE. These are the normal modes. Then we get the real part.}
%
%\section{Future Ideas}
%
%\begin{itemize}
%	\item Write the Fokker Planck Equation for the linearized FK model
%	\item Write the Fokker Planck Equation for the non-linearized FK model
%	\item Try to exactly solve the system of Langevin equations of the linearized FK model using Fourier Transform
%	\item Try to exactly solve the system of Langevin equations of the non-linearized FK model using Fourier Transform
%\end{itemize}
%
%
%\section{Appendix}
%
%\subsection{Eigenvalues of tridiagonal symmetric matrix}
%
%
%Lets take the matrix $ \textbf{M} $ as such:
%
%\[ \textbf{M} = 
%\left[
%\begin{array}{cccccc}
%a & c & 0 & 0 & \dots & 0 \\ 
%b & a & c & 0 & \dots & 0 \\ 
%0 & b & a & c & \dots & 0 \\ 
%\vdots &  &  &  &  & \vdots \\ 
%0 & 0 & \dots & b & a & c \\ 
%0 & 0 & \dots & 0 & b & a
%\end{array} 
%\right]  \]
%
%Then, its possible to show that its eigenvalues are 
%\[ \omega_{k} = a - 2\sqrt{bc}\cos\left(\frac{k\pi }{n+1}\right),\; 
%k=1,2,\dots,n \]
%
%
%\subsubsection{Chebyshev Polynomials}
%
%There are two types of Chebyshev Polynomials that can be defined.
%
%\begin{center}
%	\begin{tabular}{c|c}
%		Type 1 & Type 2 \\ 
%		\hline 
%		$T_{0}(x)=1$ & $U_{0}(x)=1$ \\ 
%		$T_{1}(x)=x$ & $U_{1}(x)=2x$ \\ 
%		$T_{n+1}(x)=2xT_{n}(x)-T_{n-1}(x)$ & $U_{n+1}(x)=2xU_{n}(x)-U_{n-1}(x)$ \\ 
%	\end{tabular} 
%\end{center}
%
%Both of these types can be written with trigonometric formulae.
%
%\underline{\textbf{Chebyshev Polynomials of Type 1}}
%
%Now, we have the trigonometric formula that passes the sum of cosines to the product of cosines.
%\[ \cos(A-B) + \cos(A+B) = 2\cos(A)\cos(B) \]
%\[ \cos(A+B) = 2\cos(A)\cos(B) - \cos(A-B) \]
%
%From this, we can show that:
%\[ \cos((n+1)A) = \cos(nA + A) = 2\cos(A)\cos(nA) - \cos((n-1)A) \]
%
%This means that $ \cos(nA) $ follows the same pattern as the Chebyshev Polynomials if $ x=\cos(A) $. In fact, since when $ |x|\leq1 $ there always exists $ \theta $ such that $ x=\cos(\theta) $, we can write the Chebyshev polynomials as $ T_{n}(\cos(\theta)) = \cos(n\theta) $.
%
%Notice that, if $ n=0\text{ then }T_{0}(\cos(\theta))=\cos(0)=1 $, and if $ n=1 $ then $ T_{1}(\cos(\theta))=\cos(\theta) $.
%
%We can show for the hyperbolic cosine that 
%\[ \cosh(x+y) = \cosh(x)\cosh(y) + \sinh(x)\sinh(y) ,\]
%and since $ \sinh(-y)=-\sinh(y)\text{ and }\cosh(-y)=\cosh(y) $, we can also show that:
%\[ \cosh(A+B) + \cosh(A-B) = 2\cosh(A)\cosh(B) \]
%\[ \cosh((n+1)A) = 2\cosh(A)\cosh(nA) - \cosh((n-1)A) \]
%
%Just as before, we can use the idea that when $ x\geq 1 $, then there exists $ \theta $ such that $ x=\cosh(\theta) $ (because $ \cosh(\theta)\geq1$ and it is a continuous function), and so we can write $ T_{n}(x) = T_{n}(\cosh(\theta)) = \cosh(n\theta) $.
%
%When $ x\leq -1 $, then we can have $ \theta $ such that $ -\cosh(\theta) = x $ , from which we get $ T_{n}(x) = T_{n}(-\cosh(\theta))=(-1)^{n}\cosh(n\theta) $.
%
%Using the inverse trigonometric functions, we could also write the Chebyshev polynomials of type 1 as
%%\[ T_{n}(x) = 
%%\begin{cases}
%%\cos(n\arccos(x)), |x|\leq 1 \\
%%\cosh(n\arccosh(x)), x\geq 1 \\
%%(-1)^{n}\cosh(n\arccosh(-x)), x\leq1
%%\end{cases} \]
%
%From this formulae, we can see that the roots of the Chebyshev polynomials of type 1 are
%\[ x_{k} = \cos\left( \frac{\pi(k+1/2) }{n }  \right),\; k=0,1,2,\dots,n-1 \]
%
%In fact, it has no roots outside the interval $ [-1,1] $.
%
%\underline{\textbf{Chebyshev Polynomials of Type 2}}
%
%\textcolor{red}{Do the same with sine.}
%%
%%\[ U_{n}(x) = 
%%\begin{cases}
%%\frac{\sin((n+1)\arccos(x))}{\sin(\arccos(x))}, |x|\leq 1 \\
%%\\
%%\frac{\sinh((n+1)\arccosh(x))}{\sinh(\arccosh(x))}, x\geq 1 \\
%%\\
%%(-1)^{n}\frac{\sinh((n+1)\arccosh(-x))}{\sinh(\arccosh(-x))}, x\leq1
%%\end{cases} \]
%
%From this formulae, we can see that the roots of the Chebyshev Polynomials of type 2 are
%\[ x_{k}=\cos\left(\frac{k \pi }{n+1 }\right), \; k=1,2,\dots,n \]
%
%\subsubsection{Eigenvalues of a tridiagonal matrix}
%
%The eigenvalues of $ \textbf{M} $ are the roots of the polynomial
%\[ \phi_{n} = \det(\textbf{M}-\lambda\mathbb{I}) = 0 .\]
%
%Lets use the notation $ \phi_{n} $ for the polynomial of the $ n \times n $ matrix $ M $. When we are using a matrix that follows the same pattern, but has size $ k\times k $, we shall write its polynomial as $ \phi_{k} $.
%
%Now, we can solve this by a recurrence relation. Lets write $ \textbf{M}_{a,b} $ for the minor matrix we get by removing the $ a-th $ row and $ b-th $ column from the matrix $ \textbf{M} $. Then, expanding the determinant by the $ n-th $ row, we get:
%\[ \phi_{n} = 
%(-1)^{n+n}(a-\lambda)\phi_{n-1}+
%(-1)^{n-1+n}b\det(\textbf{M}_{n,n-1}-\lambda\mathbb{I}) \]
%\[ \phi_{n} = 
%(a-\lambda)\phi_{n-1}-
%b\det(\textbf{M}_{n,n-1}-\lambda\mathbb{I}) \]
%
%Where we are kinda abusing the notation of the identity matrix, using the same symbol for identity matrices of different sizes. Now, we can again expand the minor matrix $ \textbf{M}_{n,n-1} $ again by its last row, and to simplify our notation, lets use $ \textbf{M}^{'}=\textbf{M}_{n,n-1} $. Before that we write the matrix to remember its face.
%
%
%\[ \textbf{M}_{n,n-1} = 
%\left[
%\begin{array}{cccccc}
%a & c & 0 & 0 & \dots & 0 \\ 
%b & a & c & 0 & \dots & 0 \\ 
%0 & b & a & c & \dots & 0 \\ 
%\vdots &  &  &  &  & \vdots \\ 
%0 & 0 & \dots & b & a & 0 \\ 
%0 & 0 & \dots & 0 & b & c
%\end{array} 
%\right]  \]
%
%\[ \det(\textbf{M}^{'}-\lambda\mathbb{I}) = 
%(-1)^{n-1+n-1}c \det(\textbf{M}_{n-1,n-1}^{'} - \lambda\mathbb{I}) +
%(-1)^{n-1+n-2}b \det(\textbf{M}_{n-1,n-2}^{'} - \lambda\mathbb{I})\]
%
%We notice that, in the second term of the right hand side we are looking at the determinant of a matrix that has a columns only with zeros, which means it is just zero! Also, we can notice that the first term is just $ \phi_{n-2} $. This means that:
%\[ \phi_{n} = (a-\lambda)\phi_{n-1} - bc\phi_{n-2} \]
%
%This looks a bit like the Chebyshev Polynomials. In fact, since the determinant is such that $ \det(\alpha\cdot \textbf{M})=\alpha\cdot \det(\textbf{M}) $, we can actually look at the determinant of $ (1/\sqrt{bc})\textbf{M} $, for which we shall have:
%\[ \phi_{n} = \left(\frac{a }{\sqrt{bc} }-\lambda \right)\phi_{n-1} - \frac{b }{\sqrt{bc} }\frac{c }{\sqrt{bc} }\phi_{n-2} \]
%\[ \phi_{n} = \left(\frac{a }{\sqrt{bc} }-\lambda \right)\phi_{n-1}-\phi_{n-2} \]
%
%Now this has the exact shape of the Chebyshev Polynomials, if we identify $ x=(a/\sqrt{bc} - \lambda)/2 $. The question is which type of Chebyshev Polynomials is this, and the answer is that this is the type 2. In fact, if our matrix is a scalar, we have only $ (a/\sqrt{bc} - \lambda) $, which is $ 2x $, meaning that $ \phi_{1}=2x \implies  \phi_{n}=U_{n}(x) $.
%
%
%Since we know the roots of Chebyshev Polynomials, we know the eigenvalues of $ (1/\sqrt{bc})\textbf{M} $.
%\[ \frac{a }{\sqrt{bc} } - \lambda_{k}^{'} = 2 \cos\left( \frac{k\pi }{n+1 }  \right), k=0,1,2,\dots,n-1  \]
%\[  \lambda_{k}^{'} =\frac{a }{\sqrt{bc} } -  2 \cos\left( \frac{k\pi }{n+1 }  \right), k=0,1,2,\dots,n-1  \]
%
%
%To finish this calculation, we then use the fact that the eigenvalues of $ (1/\sqrt{bc})\textbf{M} $ are actually the eigenvalues of $ \textbf{M} $ times $ 1/\sqrt{bc} $.
%\begin{mdframed}
%	\[ \lambda_{k} = a - 2\sqrt{bc}\cos\left( \frac{k\pi }{n+1 }  \right), k=0,1,2,\dots,n-1 \]
%\end{mdframed}
%
%
%
%Wikipedia - Chebyshev Polynomials
%Numerical Mathematics - Alfio Quarteroni, Riccardo Sacco, Fausto Saleri
%
%Devadatta Kulkarni, Darrell Schmidt, Sze-Kai Tsui. Eigenvalues of tridiagonal pseudo-Toeplitz
%matrices. Linear Algebra and its Applications, Elsevier, 1999, 297, pp.63-80. ff10.1016/S0024-
%3795(99)00114-7ff. ffhal-01461924
%
%Mecânica Analítica - Nivaldo A. Lemos
